;=================================================
;擴充微調
;function名稱開頭都是EVENT_EXTRA_R_,對應PRINTFORML開頭編號
;=================================================
@EVENT_EXTRA_R1

$RESET_PAGE
P=0

$DRAW_PAGE
PRINTFORML
PRINTFORML
PRINTFORML
LOCAL = LINECOUNT
REDRAW 0
CLEARLINE LINECOUNT - LOCAL
CUSTOMDRAWLINE =
PRINTL 私人設定
DRAWLINE
PRINTV DAY+1
PRINT 日
IF TIME == 0
	PRINTL  午前
ELSE
	PRINTL  午後
ENDIF

PRINTFORML 所持金：{MONEY}點
DRAWLINE

$INPUT_LOOP_EXTRA_R1
RESULT = 0
TRYCALLFORM EVENT_EXTRA_P_{P}
SIF RESULT != 1
	GOTO RESET_PAGE

REPEAT LOCAL + 22 - LINECOUNT
	PRINTL
REND

DRAWLINE
;PRINTLC  [997] - 前一頁
PRINTLC  [999] - 返回
;PRINTLC  [998] - 后一頁
PRINTL

INPUT

SIF RESULT == 999
	RETURN 0
SIF RESULT == 998
	P++
SIF RESULT == 997
	P--

TRYCALLFORM EVENT_EXTRA_R_{RESULT}

SIF RESULT != 1
	GOTO DRAW_PAGE

;
;-------------------------------------------------
;PAGE - 0
;-------------------------------------------------
@EVENT_EXTRA_P_0
PRINTFORML [0]  - 魔王等級簡易升級         現在：\@ GETBIT(FLAG:700,1) ? ON # OFF \@
PRINTFORML [1]  - 魔王的每日津貼           現在：{FLAG:701}
PRINTFORML [2]  - 勇者頻繁進攻             現在：\@ GETBIT(FLAG:700,3) ? ON # OFF \@
PRINTFORML [3]  - 改造敏感身體
PRINTFORML [4]  - 反抗刻印削弱
PRINTFORML [5]  - 接受洗腦
PRINTFORML [6]  - 臣服侍奉
PRINTFORML [7]  - 接受誘惑
PRINTFORML [8]  - 陷入愛慕
PRINTFORML [9]  - 陷入淫亂
PRINTFORML [10] - 生命搖籃
PRINTFORML [11] - 莉莉出現時間             現在：{FLAG:702}
PRINTFORML [12] - 狂王分身出現時間         現在：{FLAG:703}
PRINTFORML [13] - 未熟調教開關             現在：\@ GETBIT(FLAG:700,4) ? ON # OFF \@
RETURN 1

;
;-------------------------------------------------
;PAGE - 1
;-------------------------------------------------
@EVENT_EXTRA_P_1
RETURN 1

;
;-------------------------------------------------
;魔王等級經驗大幅下降
;-------------------------------------------------
@EVENT_EXTRA_R_0
INVERTBIT FLAG:700,1

;
;-------------------------------------------------
;魔王每日津貼
;-------------------------------------------------
@EVENT_EXTRA_R_1
DRAWLINE
PRINTFORML 想更改魔王每日津貼至多少呢 ?
PRINTFORML [0] - [200] - [1000] - [10000] - [50000] - [100000] - [500000] - [1000000] - [5000000]
INPUT

IF RESULT > 5000000
	PRINTFORMW 印鈔場上限為500萬,超過500萬自動變更為500萬
	FLAG:701 = 5000000
	PRINTFORMW 每日津貼已更新為: {FLAG:701}
ELSE
	FLAG:701 = RESULT
	PRINTFORMW 每日津貼已更新為: {FLAG:701}
ENDIF

;
;-------------------------------------------------
;勇者進攻頻繁
;-------------------------------------------------
@EVENT_EXTRA_R_2
INVERTBIT FLAG:700,3


;
;-------------------------------------------------
;改造敏感身體
;-------------------------------------------------
@EVENT_EXTRA_R_3
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 將其作多項屬性改變
PRINTL 要改造哪個奴隸？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF TALENT:TARGET:700 == 1
	PRINTFORMW %SAVESTR:TARGET% 都被改造過了,你想讓奴隸敏感致死不成?
	RETURN 0
ENDIF

PRINTFORML 改造%SAVESTR:RESULT% 的身體 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	SIF TALENT:TARGET:43 == 1
		TALENT:TARGET:43 = 0

	TALENT:TARGET:42 = 1
	TALENT:TARGET:47 = 1
	TALENT:TARGET:52 = 1
	TALENT:TARGET:57 = 1
	TALENT:TARGET:60 = 1
	TALENT:TARGET:61 = 1

	SIF TALENT:TARGET:62 == 1
		TALENT:TARGET:62 = 0

	TALENT:TARGET:64 = 1

	TALENT:TARGET:70 = 1

	SIF TALENT:TARGET:71 == 1
		TALENT:TARGET:71 = 0

	TALENT:TARGET:72 = 1
	TALENT:TARGET:73 = 1
	TALENT:TARGET:74 = 1
	TALENT:TARGET:75 = 1
	TALENT:TARGET:77 = 1
	TALENT:TARGET:78 = 1

	TALENT:TARGET:88 = 1
	TALENT:TARGET:89 = 1

	TALENT:TARGET:91 = 1
	TALENT:TARGET:92 = 1

	SIF TALENT:TARGET:101 == 1
		TALENT:TARGET:101 = 0
	TALENT:TARGET:102 = 1

	SIF TALENT:TARGET:103 == 1
		TALENT:TARGET:103 = 0
	TALENT:TARGET:104 = 1

	SIF TALENT:TARGET:105 == 1
		TALENT:TARGET:105 = 0
	TALENT:TARGET:106 = 1

	SIF TALENT:TARGET:107 == 1
		TALENT:TARGET:107 = 0
	TALENT:TARGET:108 = 1

	TALENT:TARGET:113 = 1

	SIF TALENT:TARGET:150 == 1
		TALENT:TARGET:150 = 0

	TALENT:TARGET:230 = 1
	TALENT:TARGET:231 = 1
	TALENT:TARGET:232 = 1
	TALENT:TARGET:233 = 1

	TALENT:TARGET:271 = 1
	TALENT:TARGET:272 = 1
	TALENT:TARGET:282 = 1

	TALENT:TARGET:700 == 1

	PRINTFORMW %SAVESTR:T% 取得 《被改造的超敏感身體》 
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;反抗刻印削弱
;-------------------------------------------------
@EVENT_EXTRA_R_4
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 讓奴隸的反抗刻印下降一個等級
PRINTL 要削弱誰的反抗刻印呢？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF MARK:3 <= 0
	PRINTFORMW %SAVESTR:TARGET% 並沒有反抗刻印。
	RETURN 0
ENDIF

PRINTFORML 讓%SAVESTR:RESULT% 削弱反抗刻印 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	MARK:3 -= 1
	MARK:4 -= 1
	PRINTFORMW 《%SAVESTR:T% 反抗刻印已削弱至Lv {MARK:4} 》
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;接受洗腦
;-------------------------------------------------
@EVENT_EXTRA_R_5
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 讓不受洗腦的奴隸消除洗腦抵抗
PRINTL 要誰接受洗腦呢？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF TALENT:TARGET:152 == 0
	PRINTFORMW %SAVESTR:TARGET% 能被洗腦,不需要改造
	RETURN 0
ENDIF

PRINTFORML 讓%SAVESTR:RESULT% 消除洗腦抵抗 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	TALENT:TARGET:152 = 0
	PRINTFORMW %SAVESTR:T% 《不受洗腦》 已被移除
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;接受侍奉
;-------------------------------------------------
@EVENT_EXTRA_R_6
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 讓不受侍奉的奴隸消除侍奉抵抗
PRINTL 要誰願意侍奉呢？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF TALENT:TARGET:151 == 0
	PRINTFORMW %SAVESTR:TARGET% 能侍奉,不需要改造
	RETURN 0
ENDIF

PRINTFORML 讓%SAVESTR:RESULT% 消除侍奉抵抗 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	TALENT:TARGET:151 = 0
	PRINTFORMW %SAVESTR:T% 《絕不侍奉》 已被移除
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;接受誘惑
;-------------------------------------------------
@EVENT_EXTRA_R_7
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 讓不受誘惑的奴隸消除誘惑抵抗
PRINTL 要誰接受誘惑呢？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF TALENT:TARGET:69 == 0
	PRINTFORMW %SAVESTR:TARGET% 能被誘惑,不需要改造
	RETURN 0
ENDIF

PRINTFORML 讓%SAVESTR:RESULT% 消除誘惑抵抗 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	TALENT:TARGET:69 = 0
	PRINTFORMW %SAVESTR:T% 《誘惑抵抗》 已被移除
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;強制愛慕
;-------------------------------------------------
@EVENT_EXTRA_R_8
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 使其因為錢而愛上你
PRINTL 要讓哪個奴隸陷入愛慕呢？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF TALENT:TARGET:85 == 1 || TALENT:TARGET:76 == 1
	PRINTFORMW %SAVESTR:TARGET% 已陷入愛慕或者淫亂無法改造
	RETURN 0
ENDIF

PRINTFORML 讓%SAVESTR:RESULT% 愛上你 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	TALENT:TARGET:85 = 1
	PRINTFORMW %SAVESTR:T% 對你有了 《愛慕》 
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;強制淫亂
;-------------------------------------------------
@EVENT_EXTRA_R_9
#DIM NO_PAGE = 0
#DIM L_LCOUNT
#DIM NUM_PAGE = 23

$INPUT_LOOP
CUSTOMDRAWLINE =
PRINTL 使其因為錢而變的淫亂
PRINTL 要讓哪個奴隸陷入淫亂呢？
DRAWLINE
CALL LIFE_LIST(NO_PAGE,,NUM_PAGE)
PRINTLC [1000] - 上一頁
PRINTLC [999] - 返  回
PRINTLC [1001] - 下一頁
PRINTL 

INPUT
SIF RESULT == 0
	RESULT = MASTER
IF RESULT == 999
	RETURN 0
ELSEIF RESULT == 1000		;上一頁
	IF NO_PAGE > 0
		NO_PAGE --
		CLEARLINE LINECOUNT-L_LCOUNT		
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT == 1001		;下一頁
	IF (NO_PAGE+1) * NUM_PAGE <= CHARANUM
		NO_PAGE ++
		CLEARLINE LINECOUNT-L_LCOUNT
	ENDIF
	GOTO INPUT_LOOP
ELSEIF RESULT < 0 || RESULT >= CHARANUM
	GOTO INPUT_LOOP
;臨死中のキャラは排除
ELSEIF BASE:RESULT:0 < 1
	GOTO INPUT_LOOP
ELSEIF CFLAG:RESULT:1 == 2
	PRINTFORMW %SAVESTR:RESULT%還不在你的統治之下。
	RETURN 0
ENDIF

T = RESULT
TARGET = RESULT

IF TALENT:TARGET:85 == 1 || TALENT:TARGET:76 == 1
	PRINTFORMW %SAVESTR:TARGET% 已陷入愛慕或者淫亂無法改造
	RETURN 0
ENDIF

PRINTFORML 讓%SAVESTR:RESULT% 變的淫亂 ？

PRINTL  [0] - 好的
PRINTL  [1] - 不要

INPUT

IF RESULT == 1
	RETURN 0
ELSEIF RESULT == 0
	TALENT:TARGET:76 = 1
	PRINTFORMW %SAVESTR:T% 變得 《淫亂》 了
ELSE
	GOTO INPUT_LOOP
ENDIF

;
;-------------------------------------------------
;生命搖籃
;-------------------------------------------------
@EVENT_EXTRA_R_10
IF FLAG:82 == 0 && CHARANUM > 60
    PRINTW 勇者數量過多
ELSEIF FLAG:87 == 0 && FLAG:89 == 0 && FLAG:91 == 0 && CHARANUM > 65
	PRINTW 勇者數量過多
ELSEIF ((FLAG:87 * FLAG:89 == 0) && (FLAG:89 * FLAG:91 == 0) && (FLAG:91 * FLAG:87 == 0)) && CHARANUM > 70
	PRINTW 勇者數量過多
ELSEIF (FLAG:87 == 0 || FLAG:89 == 0 || FLAG:91 == 0) && CHARANUM > 75
	PRINTW 勇者數量過多
ELSEIF FLAG:92 < 15  && CHARANUM > 80	
    PRINTW 勇者數量過多
ELSEIF CHARANUM >= MAX_CHARANUM
	PRINTW 勇者數量過多
ELSE
	CALL CHAR_CREATE(0)	
ENDIF

;
;-------------------------------------------------
;莉莉出現日
;-------------------------------------------------
@EVENT_EXTRA_R_11
DRAWLINE
PRINTFORML 想更改莉莉在哪天之後出現 ?
PRINTFORML [100] - [150] - [200] - [250] - [365]
INPUT

FLAG:702 = RESULT
PRINTFORMW 莉莉出現日已更新為: {FLAG:702}

;
;-------------------------------------------------
;狂王分身出現日
;-------------------------------------------------
@EVENT_EXTRA_R_12
DRAWLINE
PRINTFORML 想更改狂王分身在哪天之後出現 ?
PRINTFORML [350] - [400] - [500] - [700] - [1000] - [2000] - [3000]
INPUT

FLAG:703 = RESULT
PRINTFORMW 狂王分身出現日已更新為: {FLAG:703}

;
;-------------------------------------------------
;未熟調教開關
;-------------------------------------------------
@EVENT_EXTRA_R_13
INVERTBIT FLAG:700,4