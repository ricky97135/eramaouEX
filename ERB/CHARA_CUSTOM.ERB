@CHAR_DEBUG(ARG)
DRAWLINE
PRINTFORML [1] 登錄角色
PRINTFORML [2] 修改素質
PRINTL [0] 返回
INPUT

IF RESULT == 1
	CALL CHAR_CREATE(1)
ELSEIF RESULT == 2
	CALL CHAR_CUSTOM, ARG ,1
ELSE
	RETURN
ENDIF
RESTART

@CHAR_CREATE(ARG)
#DIM L_I
DRAWLINE
PRINTFORML 使用神奇的生命搖籃，憑空創造出一個角色
PRINTFORML 這角色的一切，完全由魔王大人你自己定製
SIF ARG == 0
    PRINTFORML 這將耗費大量的金錢，幸好只看不買是免費的
DRAWLINE
PRINTL
WAIT

PRINTL ■=== 勇者 ===■
FOR L_I, 1, 17
	PRINTFORM  [{L_I,2}] %CSVNAME(L_I),14,LEFT%
	SIF L_I % 5 == 0
		PRINTL
NEXT
SIF !LINEISEMPTY()
	PRINTL

PRINTL ■=== 精英 ===■
FOR L_I, 1, 11
	PRINTFORM  [{L_I+20,2}] %CSVNAME(L_I+200),14,LEFT%
	SIF L_I % 5 == 0
		PRINTL
NEXT
SIF !LINEISEMPTY()
	PRINTL

IF ARG == 1	
PRINTL ■=== 特殊 ===■
LOCAL = 0
FOR L_I, 17, 40
	SIF !EXISTCSV(L_I) || L_I == 19 || L_I == 18
		CONTINUE
	PRINTFORM  [{L_I+20,2}] %CSVNAME(L_I),14,LEFT%
	LOCAL ++
	SIF LOCAL % 5 == 0
		PRINTL
NEXT
SIF !LINEISEMPTY()
	PRINTL
ENDIF
	
DRAWLINE
PRINT [999] 返回

$INPUT_LOOP
INPUT 1

SELECTCASE RESULT
CASE 999
	RETURN 0
CASE 1 TO 16
	L_I = RESULT
CASE 21 TO 30
	L_I = RESULT -20 +200
CASE 37 TO 60
	L_I = RESULT -20
CASEELSE
	L_I = RESULT
ENDSELECT

IF !EXISTCSV(L_I)
	CLEARLINE 1
	GOTO INPUT_LOOP
ENDIF

A = -1

;啟用目前已登錄的角色
SIF INRANGE(L_I,17,40)
	A = FINDCHARA(NO, L_I)

;登錄新的角色
IF A < 0
	CALL CHAR_APPEND(L_I, ARG)
	A = RESULT
	PRINTFORMW 你召喚出了%SAVESTR:A%……
ENDIF

CALL CHAR_CUSTOM, A ,ARG



; ARG：csv編號（需要保證可用）
@CHAR_APPEND(ARG, ARG:1)
ADDCHARA ARG
CALL ADDCHARA_EX, CHARANUM-1
LOCAL = TARGET
TARGET = CHARANUM - 1
A = CHARANUM - 1

SELECTCASE ARG
;勇者 REF ENTER_ENEMY.ERB
CASE 1 TO 16
	SIF ARG:1 == 1
	    CALL CHAR_MAKE

;精英部下 REF SHOP_MONSTER.ERB
CASE 201 TO 210
	SIF ARG:1 == 1
	    CALL CHAR_MAKE
	
	;等級調整
	
;瑪奧 REF SYSTEM.ERB
CASE 17
	SAVESTR:A = %NAME:A%
	CSTR:A:1 = %NAME:A%
	CFLAG:420 = 1
	
	CFLAG:9 = 1
	CFLAG:1 = 0
	CFLAG:11 = 15
	CFLAG:12 = 15
	CFLAG:13 = 15
	CFLAG:14 = 15
	CFLAG:16 = -1
	
	CALL CHAR_BODY_GENERATE_WAPPED, 1
	
;莉莉 REF ENTER_ENEMY.ERB
CASE 24
	SAVESTR:A = %NAME:A%
	CSTR:A:1 = %NAME:A%
	;初期裝備：劍
	CFLAG:A:550 = 40
	;著替え裝著
	TARGET = A
	CALL WEARING_CLOTH_ABLE
	CALL CHAR_BODY_GENERATE_WAPPED, A

;撲克牌 REF ARCANA_FORT
CASE 20 TO 23
	;東の砦　黑方片 &1
	IF ARG == 22
		;初期裝備：劍
		CFLAG:A:550 = 40
		;初期裝備：強度
		CFLAG:A:550 += 9000
		;初期裝備接頭語：ダーク
		CFLAG:A:550 += 900000
		;名前決定
		CFLAG:A:6 = RAND:80
	;西の砦　白梅花 &4
	ELSEIF ARG == 23
		ABL:A:31 = 1
		EXP:A:10 = 30
		;初期裝備：法杖
		CFLAG:A:550 = 41
		;初期裝備：強度
		CFLAG:A:550 += 9000
		;初期裝備接頭語：アイス
		CFLAG:A:550 += 600000
		;名前決定
		CFLAG:A:6 = RAND:80
	;南の砦　銀黑桃 &2
	ELSEIF ARG == 21
		EXP:A:10 = 10
		;初期裝備：手裡劍
		CFLAG:A:550 = 44
		;初期裝備：強度
		CFLAG:A:550 += 9000
		;初期裝備接頭語：デス
		CFLAG:A:550 += 300000
		;名前決定
		CFLAG:A:6 = RAND:80
	;北の砦　金紅桃 &8
	ELSEIF ARG == 20
		EXP:A:0 = 20
		;狂王が男か扶她ならば精液經驗
		SIF FLAG:500 == 0 || FLAG:500 == 2
			EXP:A:5 = EXP:A:0
		;初體験の相手は狂王
		CFLAG:A:15 = 105
		;初期裝備：細劍
		CFLAG:A:550 = 50
		;初期裝備：強度
		CFLAG:A:550 += 10000
		;初期裝備接頭語：スラッシュ
		CFLAG:A:550 += 400000
		;名前決定
		CFLAG:A:6 = RAND:80
	ENDIF

	SAVESTR:A = %NAME:A%
	CSTR:A:1 = %NAME:A%
	
	;衣裝全裝備
	CALL WEARING_CLOTH_ABLE
	CALL CHAR_BODY_GENERATE_WAPPED, A

	;レベルアップ処理
	IF FLAG:60 > 0
		REPEAT FLAG:60
			CALL ST_UP, A
		REND
	ENDIF

	BASE:A:0 = MAXBASE:A:0
	BASE:A:1 = MAXBASE:A:1

;貢品 REF ENDING.ERB
CASE 35, 31 TO 33
	CALL CHAR_INIT
; 狂王替身 葵希羅
CASE 34
	FLAG:224 = 1

	A = CHARANUM - 1
	SAVESTR:A = %NAME:A%
	CSTR:A:1 = %NAME:A%

	;著替え裝著
	TARGET = A
	CALL WEARING_CLOTH_ABLE
	CALL CHAR_BODY_GENERATE_WAPPED, A
ENDSELECT

IF ARG:1 == 0 
	PRINTFORMW 請問登陸的角色是什麼性別呢？
	DRAWLINE
	PRINTFORMW [1] 男性			[2] 女性			[3] 扶她
	INPUT
	SIF RESULT == 1
		TALENT:A:122 == 1
	SIF RESULT == 3
		TALENT:A:121 == 1
	DRAWLINE
   $INPUT_LOOP
   PRINTFORML 新建人物的名字是？（不輸入將隨機產生名字）
   INPUTS
          CALL CHARA_NAME_RANDOM_DEFINE(A)
   LOCALS '= RESULTS
   SELECTCASE STRLENS(LOCALS)
   CASE IS > 16
	   PRINTFORMW 名字太長，請使用全形八字以下的名字。
	   GOTO INPUT_LOOP
   CASE IS > 0
       PRINTFORMW 新建人物今後被稱呼為%LOCALS%。
	   CALLNAME:A '= LOCALS
	   SAVESTR:A '= LOCALS
	   NAME:A '= LOCALS
   CASEELSE
	   CALL CHARA_NAME_RANDOM_DEFINE(A)
	   PRINTFORMW 新建人物今後被稱呼為%NAME:A%。
   ENDSELECT
ENDIF
CFLAG:A:1 = 0

TARGET = LOCAL
RETURN A



