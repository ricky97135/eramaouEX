;------------------------------------------------------------
;魔界銀行處理相關
;------------------------------------------------------------
@MAKAI_BANK
CALL INTEREST
$BANK
DRAWLINE
PRINTFORML 歡迎進入魔界銀行遠端客戶端，您目前的存款為{EX_FLAG:9001}，現金為{MONEY}。
PRINTL [1] 存款
PRINTL [2] 取款
PRINTL [3] 貸款
PRINTL [4] 還款
PRINTL [9] 返回
DRAWLINE
INPUT
IF RESULT == 1
	PRINTFORML 請輸入需要存入的資金數量,返回上層請輸入0。(目前的存款為{EX_FLAG:9001}現金為{MONEY})
	$INPUT_LOOP_0
	INPUT
		IF RESULT > 0 && MONEY >= RESULT
		EX_FLAG:9001 += RESULT
		MONEY -= RESULT
		EX_FLAG:4444 -= RESULT
		PRINTFORMW 已轉移{RESULT}資金至銀行。	
		GOTO BANK
	ELSEIF MONEY < RESULT
		PRINTFORML 您的操作有誤，請重新輸入,返回上層請輸入0。
		GOTO INPUT_LOOP_0
	ELSEIF RESULT == 0
		PRINTFORMW 正在返回上層
		GOTO BANK
	ELSE
		GOTO INPUT_LOOP_0
	ENDIF
ELSEIF RESULT == 2
	PRINTFORML 請輸入需要取出的資金數量,返回上層請輸入0。(目前的存款為{EX_FLAG:9001}現金為{MONEY})
	$INPUT_LOOP1
	INPUT
		IF RESULT > 0 && EX_FLAG:9001 >= RESULT
		EX_FLAG:9001 -= RESULT
		MONEY += RESULT
		EX_FLAG:4444 += RESULT
		PRINTFORMW 已提取{RESULT}資金。
		GOTO BANK	
		ELSEIF EX_FLAG:9001 < RESULT
		PRINTFORML 您的操作有誤，請重新輸入,返回上層請輸入0。
		GOTO INPUT_LOOP1
	ELSEIF RESULT == 0
		PRINTFORMW 正在返回上層
		GOTO BANK
	ELSE
		GOTO INPUT_LOOP1
	ENDIF
ELSEIF RESULT == 3
		IF CFLAG:0:9<10
		B=100000 + CFLAG:0:9 * 10000
	ELSEIF 	CFLAG:0:9>=10 && CFLAG:0:9<51
		B=200000 + (CFLAG:0:9-10) * 100000
	ELSEIF 	CFLAG:0:9>=51 && CFLAG:0:9<101
		B=4200000 + (CFLAG:0:9-50) * 1000000
	ELSE
		B=54200000 + (CFLAG:0:9-100) * 10000000
	ENDIF
	PRINTFORML 請輸入貸款金額,返回上層請輸入0。(目前欠款為{EX_FLAG:9003}貸款額度為{B})
	PRINTFORML 貸款利息為百分之二十，本息超過額度將無法借貸或追加借貸。
	PRINTFORML 還款期限為三十天，從初次借貸時開始計算,逾期未還款將強制徵收本息百分之五十的滯納金
	$INPUT_LOOP2
	INPUT
		IF RESULT > 0 && RESULT <= (B-EX_FLAG:9003)
		EX_FLAG:9003 += RESULT * 12 / 10	
		MONEY += RESULT
		EX_FLAG:4444 += RESULT
		PRINTFORMW 已貸款{RESULT}資金。
		GOTO BANK	
	ELSEIF RESULT > 0 && RESULT > (B-EX_FLAG:9003)
		PRINTFORML 您的額度不足，請重新輸入,返回上層請輸入0。
		GOTO INPUT_LOOP2
	ELSEIF RESULT == 0
		PRINTFORMW 正在返回上層
		GOTO BANK
	ELSE
		GOTO INPUT_LOOP2
	ENDIF
ELSEIF RESULT == 4
	PRINTFORML 請輸入還款金額,返回上層請輸入0。(目前欠款為{EX_FLAG:9003})
	$INPUT_LOOP3
	INPUT
		IF RESULT <= EX_FLAG:9003 && MONEY - RESULT > 0
		EX_FLAG:9003 -= RESULT
		MONEY -= RESULT
		EX_FLAG:4444 -= RESULT
		PRINTFORMW 已償還{RESULT}資金。
		GOTO BANK

   	ELSEIF MONEY-RESULT < 0
		PRINTFORML 您沒有足夠的資金，請重新輸入,返回上層請輸入0。
		GOTO INPUT_LOOP3

	ELSEIF RESULT > EX_FLAG:9003
		PRINTFORMW 您的輸入的金額超出欠款額，多餘金額將自動轉入銀行。
		EX_FLAG:9001 += RESULT - EX_FLAG:9003
		MONEY -= RESULT
		EX_FLAG:4444 -= RESULT
		EX_FLAG:9003 = 0
		GOTO BANK

	ELSEIF RESULT == 0
		PRINTFORMW 正在返回上層
		GOTO BANK
	ELSE
		GOTO INPUT_LOOP3
	ENDIF
ELSEIF RESULT == 9
	EX_FLAG:9002= DAY
	RETURN
ENDIF